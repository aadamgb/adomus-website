<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>
    <link rel="stylesheet" href="/style/calendar.css">
</head>
<body>

    <div class="container">

        <div class="text-container">
            <p>Hello {{user.username}}, choose your food for the week {{products.product_name}} </p>   {{!-- 1 --}}
        </div>
        <div class="grid">

            <div></div>
            <div class="item breakfast">Breakfast</div>
            <div class="item lunch">Lunch</div>
            <div class="item dinner">Dinner</div>
            <div class="item snacks">Snacks</div>
            <div class="item order"></div>

            <div class="item week"></div>   {{!-- 7 --}}
            <li class="mon">Monday</li>
            <li class="tue">Tuesday</li>
            <li class="wed">Wednesday</li>
            <li class="thu">Thursday</li>
            <li class="fri">Friday</li>
            <li class="sat">Saturday</li>
            <li class="sun">Sunday</li>    {{!-- 14 --}}

            {{!-- Breakfast --}}

            <span class="b-mon">
                {{#each orders.[2024-06-17]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-17]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-tue">
                {{#each orders.[2024-06-18]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-18]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-wed">
                {{#each orders.[2024-06-19]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-19]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-thu">
                {{#each orders.[2024-06-20]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-20]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-fri">
                {{#each orders.[2024-06-21]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-21]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-sat">
                {{#each orders.[2024-06-22]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-22]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="b-sun">
                {{#each orders.[2024-06-23]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-23]}}
                    {{#if (eq this.CategoryID 1)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            
            {{!-- Lunch --}}

            <span class="l-mon">
                {{#each orders.[2024-06-17]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-17]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-tue">
                {{#each orders.[2024-06-18]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-18]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-wed">
                {{#each orders.[2024-06-19]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-19]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-thu">
                {{#each orders.[2024-06-20]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-20]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-fri">
                {{#each orders.[2024-06-21]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-21]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-sat">
                {{#each orders.[2024-06-22]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-22]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="l-sun">
                {{#each orders.[2024-06-23]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-23]}}
                    {{#if (eq this.CategoryID 2)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>

            {{!-- Dinner--}}

            <span class="d-mon">
                {{#each orders.[2024-06-17]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-17]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-tue">
                {{#each orders.[2024-06-18]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-18]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-wed">
                {{#each orders.[2024-06-19]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-19]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-thu">
                {{#each orders.[2024-06-20]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-20]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-fri">
                {{#each orders.[2024-06-21]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-21]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-sat">
                {{#each orders.[2024-06-22]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-22]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="d-sun">
                {{#each orders.[2024-06-23]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-23]}}
                    {{#if (eq this.CategoryID 3)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>

            {{!-- Snacks--}}

            <span class="s-mon">
                {{#each orders.[2024-06-17]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-17]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-tue">
                {{#each orders.[2024-06-18]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-18]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-wed">
                {{#each orders.[2024-06-19]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-19]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-thu">
                {{#each orders.[2024-06-20]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-20]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-fri">
                {{#each orders.[2024-06-21]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-21]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-sat">
                {{#each orders.[2024-06-22]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-22]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>
            <span class="s-sun">
                {{#each orders.[2024-06-23]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
                {{#each cart.[2024-06-23]}}
                    {{#if (eq this.CategoryID 4)}}
                        <img class="img cart" src={{this.ProductImage}}  alt="Tue">
                    {{/if}} 
                {{/each}}
            </span>

            {{!-- Order--}}

                <input type="hidden" id="userId" name="userId" value={{user.username}}>
                <span class="o-mon">
                    <button type="button" onclick="submitDate('2024-06-17')">Edit Order</button>
                </span>
                <span class="o-tue">
                    <button type="button" onclick="submitDate('2024-06-18')">Edit Order</button>
                </span>
                <span class="o-wed">
                    <button type="button" onclick="submitDate('2024-06-19')">Edit Order</button>
                </span>
                <span class="o-thu">
                    <button type="button" onclick="submitDate('2024-06-20')">Edit Order</button>
                </span>
                <span class="o-fri">
                    <button type="button" onclick="submitDate('2024-06-21')">Edit Order</button>
                </span>
                <span class="o-sat">
                    <button type="button" onclick="submitDate('2024-06-22')">Edit Order</button>
                </span>
                <span class="o-sun">
                    <button type="button" onclick="submitDate('2024-06-23')">Edit Order</button>
                </span>
        </div>

    </div>
       

    

    <script>
        let  months = [
            "January", "February", "March", "April", "May", "June", 
            "July", "August", "September", "October", "November", "December"
        ];


        let date =new Date();
        let  dayNum = date.getDay() + 7;

        if (dayNum == 7 ){
            dayNum = 14;
        }

        let day = date.getDate() ;
        let month = months[date.getMonth()];

        let year = date.getFullYear();

        let active = document.querySelector(":nth-child("+dayNum+")");
        active.classList.add('current');

        let h1 = document.createElement('h1');
        h1.innerHTML = day;
        active.appendChild(h1);

        let h5 = document.createElement('h5');
        h5.innerHTML = month;
        active.appendChild(h5);

        //let h3 = document.createElement('h3');
        // h3.innerHTML = year;
        //active.appendChild(h3);

    </script>

    <script>
        function submitDate(date) {
            let currentDate = new Date().toISOString().split('T', 1)[0];
            let datee = new Date(date);
            let day = datee.getDate();
            let  months = [
            "January", "February", "March", "April", "May", "June", 
            "July", "August", "September", "October", "November", "December"
            ];
            let month = months[datee.getMonth()];

            let  weekdays = [
            "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday",
            ];
            let week = weekdays[datee.getDay()];
            let year = datee.getFullYear();
            // Create a form element
            var form = document.createElement('form');
            form.method = 'post';
            form.action = '/auth/test';

            // Create a hidden input for the date
            var hiddenOrderDate = document.createElement('input');
            hiddenOrderDate.type = 'hidden';
            hiddenOrderDate.name = 'orderDate';
            hiddenOrderDate.value = date;

            var hiddenOrderDay = document.createElement('input');
            hiddenOrderDay.type = 'hidden';
            hiddenOrderDay.name = 'orderDay';
            hiddenOrderDay.value = day;

            var hiddenOrderWeek = document.createElement('input');
            hiddenOrderWeek .type = 'hidden';
            hiddenOrderWeek .name = 'orderWeek';
            hiddenOrderWeek .value = week;

            var hiddenOrderMonth = document.createElement('input');
            hiddenOrderMonth.type = 'hidden';
            hiddenOrderMonth.name = 'orderMonth';
            hiddenOrderMonth.value = month;

            var hiddenOrderedDate = document.createElement('input');
            hiddenOrderedDate.type = 'hidden';
            hiddenOrderedDate.name = 'orderedDate';
            hiddenOrderedDate.value = currentDate; // Current date in YYYY-MM-DD format

            // Append the hidden input to the form
            form.appendChild(hiddenOrderDay);
            form.appendChild(hiddenOrderMonth);
            form.appendChild(hiddenOrderWeek);
            form.appendChild(hiddenOrderDate);
            form.appendChild(hiddenOrderedDate);

            // Append the form to the body and submit it
            document.body.appendChild(form);
            form.submit();
        };
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var containers = document.querySelectorAll("span");
            containers.forEach( function(container) {
                var images = container.querySelectorAll('.img');
                var cartImages = container.querySelectorAll('.cart');
                var message = document.createElement('div');
                var imageWidth; // Adjust 2px for margin


                if (images.length == 1){
                    imageWidth = 50;
                }else if (images.length >= 4){
                    imageWidth = (100 / 3) - 10;
                }else{
                    imageWidth = (100 / images.length) - 10 ;
                }           
                images.forEach(function(img) {
                    img.style.width = imageWidth + '%'  ;
                    img.style.border = '2px solid green'; 
                });
                cartImages.forEach(function(img) {
                    img.style.border = '3px solid crimson'; 
                });
                message.className = 'message';
                message.textContent = 'Too many items XD';

                if (images.length > 6) {
                    container.innerHTML = ''; // Clear existing images
                    container.appendChild(message);
                }
            });
            });
            

    </script>
</body>
</html>